<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV Generator Pro - Premium CV Creator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Playfair+Display:wght@700&family=Inter:wght@400;600&family=Montserrat:wght@600;700&family=Raleway:wght@400;600&family=Lato:wght@400;700&family=Roboto:wght@400;500;700&family=Open+Sans:wght@400;600&family=Nunito:wght@600;700&family=Quicksand:wght@600;700&family=Source+Sans+Pro:wght@400;600&family=Arvo:wght@700&family=Caveat:wght@700&family=Oswald:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="cv-editor" id="cvEditor">
        <!-- MOBILE TOGGLE BUTTON -->
        <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()" aria-label="Toggle sidebar">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- SIDEBAR -->
        <aside class="editor-sidebar" id="editorSidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-file-alt"></i> CV Pro</h1>
                <p>CrÃ©ateur Premium</p>
                <button class="sidebar-close" id="sidebarClose" onclick="closeSidebar()" style="display:none;" aria-label="Close sidebar">
                    <i class="fas fa-times"></i>
                </button>
                <button class="theme-toggle" id="themeToggle" onclick="toggleDarkMode()" title="Basculer thÃ¨me sombre/clair" style="margin-top: 0.5rem; width: 100%;">
                    <i class="fas fa-moon"></i> Mode sombre
                </button>
            </div>

            <!-- TABS -->
            <nav class="editor-nav">
                <button class="nav-btn active" data-tab="content" onclick="switchTab('content')">
                    <i class="fas fa-edit"></i> Contenu
                </button>
                <button class="nav-btn" data-tab="design" onclick="switchTab('design')">
                    <i class="fas fa-palette"></i> Design
                </button>
                <button class="nav-btn" data-tab="export" onclick="switchTab('export')">
                    <i class="fas fa-download"></i> Export
                </button>
            </nav>

            <!-- TAB: CONTENU -->
            <div class="tab-panel active" id="tab-content">
                
                <!-- MODÃˆLES EXEMPLES -->
                <div class="panel-section">
                    <h3><i class="fas fa-sparkles"></i> ModÃ¨les</h3>
                    <div class="examples-grid">
                        <button class="example-btn" onclick="loadExample('dev')" title="Dev">ðŸ’»</button>
                        <button class="example-btn" onclick="loadExample('designer')" title="Designer">ðŸŽ¨</button>
                        <button class="example-btn" onclick="loadExample('startup')" title="Startup">ðŸš€</button>
                        <button class="example-btn" onclick="loadExample('marketing')" title="Marketing">ðŸ“Š</button>
                        <button class="example-btn" onclick="loadExample('datascientist')" title="Data">ðŸ¤–</button>
                        <button class="example-btn" onclick="loadExample('manager')" title="Manager">ðŸ‘”</button>
                    </div>
                </div>

                <!-- SECTION 1: PROFIL -->
                <div class="panel-section">
                    <h3><i class="fas fa-user-circle"></i> Profil Personnel</h3>

                    <div class="form-group">
                        <label><i class="fas fa-image"></i> Photo</label>
                        <div class="photo-upload-box" onclick="document.getElementById('photoInput').click()">
                            <div id="photoPreview" class="photo-preview-area"></div>
                            <p>Cliquer pour ajouter une photo</p>
                        </div>
                        <input type="file" id="photoInput" accept="image/*" onchange="handlePhotoUpload(event)" style="display:none">
                    </div>

                    <div class="form-group">
                        <label>Nom Complet</label>
                        <input type="text" id="fullName" placeholder="Jean Dupont" oninput="updatePreview()">
                    </div>

                    <div class="form-group">
                        <label>Titre Professionnel</label>
                        <input type="text" id="jobTitle" placeholder="IngÃ©nieur Senior" oninput="updatePreview()">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-envelope"></i> Email</label>
                            <input type="email" id="email" placeholder="email@example.com" oninput="updatePreview()">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-phone"></i> TÃ©lÃ©phone</label>
                            <input type="tel" id="phone" placeholder="+33 6 00 00 00 00" oninput="updatePreview()">
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-map-marker"></i> Localisation</label>
                        <input type="text" id="location" placeholder="Paris, France" oninput="updatePreview()">
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-align-left"></i> Ã€ Propos</label>
                        <textarea id="about" placeholder="DÃ©crivez votre profil professionnel..." rows="4" oninput="updatePreview()"></textarea>
                    </div>
                </div>

                <!-- SECTION 2: FORMATION -->
                <div class="panel-section">
                    <div class="section-header">
                        <h3><i class="fas fa-graduation-cap"></i> Formation</h3>
                        <button class="btn-add-item" onclick="addEducation()"><i class="fas fa-plus"></i></button>
                    </div>
                    <div id="educationList"></div>
                </div>

                <!-- SECTION 3: EXPÃ‰RIENCES -->
                <div class="panel-section">
                    <div class="section-header">
                        <h3><i class="fas fa-briefcase"></i> ExpÃ©riences</h3>
                        <button class="btn-add-item" onclick="addExperience()"><i class="fas fa-plus"></i></button>
                    </div>
                    <div id="experienceList"></div>
                </div>

                <!-- SECTION 4: COMPÃ‰TENCES -->
                <div class="panel-section">
                    <div class="section-header">
                        <h3><i class="fas fa-cogs"></i> CompÃ©tences</h3>
                        <button class="btn-add-item" onclick="addSkill()"><i class="fas fa-plus"></i></button>
                    </div>
                    <div id="skillsList"></div>
                </div>

                <!-- SECTION 5: LANGUES -->
                <div class="panel-section">
                    <div class="section-header">
                        <h3><i class="fas fa-globe"></i> Langues</h3>
                        <button class="btn-add-item" onclick="addLanguage()"><i class="fas fa-plus"></i></button>
                    </div>
                    <div id="languagesList"></div>
                </div>

                <!-- SECTION 6: INTÃ‰RÃŠTS -->
                <div class="panel-section">
                    <div class="section-header">
                        <h3><i class="fas fa-heart"></i> IntÃ©rÃªts</h3>
                        <button class="btn-add-item" onclick="addInterest()"><i class="fas fa-plus"></i></button>
                    </div>
                    <div id="interestsList"></div>
                </div>

            </div>

            <!-- TAB: DESIGN -->
            <div class="tab-panel" id="tab-design">
                
                <div class="panel-section">
                    <h3><i class="fas fa-layer-group"></i> Templates</h3>
                    <div class="templates-grid">
                        <button class="template-btn active" data-template="minimal" onclick="switchTemplate('minimal')">Minimal</button>
                        <button class="template-btn" data-template="classic" onclick="switchTemplate('classic')">Classique</button>
                        <button class="template-btn" data-template="modern" onclick="switchTemplate('modern')">Moderne</button>
                        <button class="template-btn" data-template="luxury" onclick="switchTemplate('luxury')">Luxury</button>
                        <button class="template-btn" data-template="creative" onclick="switchTemplate('creative')">CrÃ©atif</button>
                        <button class="template-btn" data-template="tech" onclick="switchTemplate('tech')">Tech</button>
                        <button class="template-btn" data-template="professionnel" onclick="switchTemplate('professionnel')">Pro 2Col</button>
                        <button class="template-btn" data-template="elegant" onclick="switchTemplate('elegant')">Ã‰lÃ©gant</button>
                        <button class="template-btn" data-template="corporate" onclick="switchTemplate('corporate')">Corporate</button>
                        <button class="template-btn" data-template="academic" onclick="switchTemplate('academic')">Academic</button>
                    </div>
                </div>

                <div class="panel-section">
                    <h3><i class="fas fa-image"></i> Photo</h3>
                    <div style="margin-bottom: 15px;">
                        <input type="file" id="photoInput" accept="image/*" onchange="handlePhotoUpload(event)" style="display: none;">
                        <button onclick="document.getElementById('photoInput').click()" style="width: 100%; padding: 10px; background: #0084ff; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-upload"></i> TÃ©lÃ©charger Photo
                        </button>
                    </div>
                    <div id="photoEditorTools" style="display: none; gap: 10px;">
                        <label style="display: block; margin-top: 10px;">
                            <small>Crop (%):</small>
                            <input type="range" id="cropSlider" min="0" max="50" value="0" oninput="applyPhotoFilter()" style="width: 100%; margin-top: 5px;">
                        </label>
                        <label style="display: block; margin-top: 10px;">
                            <small>Brightness:</small>
                            <input type="range" id="brightnessSlider" min="50" max="150" value="100" oninput="applyPhotoFilter()" style="width: 100%; margin-top: 5px;">
                        </label>
                        <label style="display: block; margin-top: 10px;">
                            <small>Contrast:</small>
                            <input type="range" id="contrastSlider" min="50" max="150" value="100" oninput="applyPhotoFilter()" style="width: 100%; margin-top: 5px;">
                        </label>
                    </div>
                </div>

                <div class="panel-section">
                    <h3><i class="fas fa-palette"></i> Couleurs</h3>
                    <div class="color-presets">
                        <button class="color-preset modern" onclick="applyColorPreset('modern')" title="Modern"></button>
                        <button class="color-preset classic" onclick="applyColorPreset('classic')" title="Classic"></button>
                        <button class="color-preset bold" onclick="applyColorPreset('bold')" title="Bold"></button>
                        <button class="color-preset minimal" onclick="applyColorPreset('minimal')" title="Minimal"></button>
                    </div>
                </div>

                <div class="panel-section">
                    <h3><i class="fas fa-fill-drip"></i> Personnaliser</h3>
                    
                    <div class="form-group">
                        <label>Couleur Principale</label>
                        <div class="color-palette">
                            <div class="color-swatch" data-color="#0ef" style="background: #0ef;" title="Cyan" onclick="setColor('#0ef')"></div>
                            <div class="color-swatch" data-color="#ff6600" style="background: #ff6600;" title="Orange" onclick="setColor('#ff6600')"></div>
                            <div class="color-swatch" data-color="#1a5f7a" style="background: #1a5f7a;" title="Bleu" onclick="setColor('#1a5f7a')"></div>
                            <div class="color-swatch" data-color="#000000" style="background: #000000;" title="Noir" onclick="setColor('#000000')"></div>
                            <div class="color-swatch" data-color="#e91e63" style="background: #e91e63;" title="Rose" onclick="setColor('#e91e63')"></div>
                            <div class="color-swatch" data-color="#4CAF50" style="background: #4CAF50;" title="Vert" onclick="setColor('#4CAF50')"></div>
                        </div>
                        <div class="color-input-wrapper" style="margin-top: 10px;">
                            <input type="color" id="primaryColor" value="#0ef" oninput="updatePreview(); syncColorHex(this.value)">
                            <span id="primaryColorHex">#0ef</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Police Titre</label>
                        <select id="fontTitle" onchange="updatePreview()">
                            <option value="Poppins">Poppins</option>
                            <option value="Playfair Display">Playfair Display</option>
                            <option value="Montserrat">Montserrat</option>
                            <option value="Roboto">Roboto</option>
                            <option value="Raleway">Raleway</option>
                            <option value="Oswald">Oswald</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Police Corps</label>
                        <select id="fontBody" onchange="updatePreview()">
                            <option value="Poppins">Poppins</option>
                            <option value="Roboto">Roboto</option>
                            <option value="Open Sans">Open Sans</option>
                            <option value="Lato">Lato</option>
                            <option value="Inter">Inter</option>
                            <option value="Nunito">Nunito</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-heading"></i> Nom (Heading)</label>
                        <div class="size-input-wrapper">
                            <input type="range" id="nameSize" min="24" max="52" value="36" oninput="updatePreview(); document.getElementById('nameSizeDisplay').textContent = this.value + 'px'">
                            <span id="nameSizeDisplay">36px</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-briefcase"></i> Titre Professionnel</label>
                        <div class="size-input-wrapper">
                            <input type="range" id="jobTitleSize" min="12" max="20" value="16" oninput="updatePreview(); document.getElementById('jobTitleSizeDisplay').textContent = this.value + 'px'">
                            <span id="jobTitleSizeDisplay">16px</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-info-circle"></i> MÃ©tadonnÃ©es</label>
                        <div class="size-input-wrapper">
                            <input type="range" id="metaSize" min="8" max="14" value="11" oninput="updatePreview(); document.getElementById('metaSizeDisplay').textContent = this.value + 'px'">
                            <span id="metaSizeDisplay">11px</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-heading"></i> Titres Sections</label>
                        <div class="size-input-wrapper">
                            <input type="range" id="sectionTitleSize" min="12" max="22" value="16" oninput="updatePreview(); document.getElementById('sectionTitleSizeDisplay').textContent = this.value + 'px'">
                            <span id="sectionTitleSizeDisplay">16px</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-align-left"></i> Taille Corps</label>
                        <div class="size-input-wrapper">
                            <input type="range" id="bodyFontSize" min="10" max="16" value="13" oninput="updatePreview(); document.getElementById('bodySizeDisplay').textContent = this.value + 'px'">
                            <span id="bodySizeDisplay">13px</span>
                        </div>
                    </div>
                </div>

            </div>

            <!-- TAB: EXPORT -->
            <div class="tab-panel" id="tab-export">

                <div class="panel-section">
                    <h3><i class="fas fa-download"></i> Exporter</h3>
                    
                    <button class="export-btn primary" onclick="exportPDF()">
                        <i class="fas fa-file-pdf"></i> PDF
                    </button>
                    
                    <button class="export-btn" onclick="exportPNG()">
                        <i class="fas fa-image"></i> PNG
                    </button>

                    <button class="export-btn" onclick="exportDOCX()">
                        <i class="fas fa-file-word"></i> Word
                    </button>

                    <button class="export-btn" onclick="exportJSON()">
                        <i class="fas fa-save"></i> Sauvegarder
                    </button>

                    <button class="export-btn secondary" onclick="triggerJSONImport()">
                        <i class="fas fa-upload"></i> Charger
                    </button>

                    <input type="file" id="jsonInput" accept=".json" style="display:none" onchange="importJSON(event)">
                </div>

                <div class="panel-section">
                    <h3><i class="fas fa-arrow-left"></i> Navigation</h3>
                    
                    <button class="export-btn secondary" onclick="goBackToDashboard()">
                        <i class="fas fa-home"></i> Mes CVs
                    </button>
                </div>

                <div class="panel-section">
                    <h3><i class="fas fa-search-plus"></i> Zoom</h3>
                    <div class="zoom-controls">
                        <button class="zoom-btn" onclick="zoomOut()"><i class="fas fa-minus"></i></button>
                        <span id="zoomLevel">100%</span>
                        <button class="zoom-btn" onclick="zoomIn()"><i class="fas fa-plus"></i></button>
                    </div>
                </div>

            </div>
        </aside>

        <!-- APERÃ‡U -->
        <main class="editor-preview" id="editorPreview">
            <div class="preview-wrapper">
                <div class="preview-container" id="previewContainer">
                    <div class="cv-page minimal-template" id="cvPreview">
                        <!-- Contenu gÃ©nÃ©rÃ© dynamiquement -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- TOAST NOTIFICATIONS CONTAINER -->
    <div class="toast-container" id="toastContainer"></div>
    
    <!-- FIREBASE INITIALIZATION MODULE -->
    <script type="module">
        // Import Firebase functions
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import {
            getFirestore, collection, addDoc, onSnapshot, query,
            orderBy, where, deleteDoc, doc, updateDoc, getDocs,
            increment, serverTimestamp, setDoc, getDoc
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import {
            getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword,
            onAuthStateChanged, signOut, signInAnonymously
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBirIXLKxkuWT7js3CB4_pGB6tk4wPa2AM",
            authDomain: "valde-tech.firebaseapp.com",
            projectId: "valde-tech",
            storageBucket: "valde-tech.firebasestorage.app",
            messagingSenderId: "1057527881640",
            appId: "1:1057527881640:web:0fa2badcf46267bee7879d"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // Expose to window
        window.db = db;
        window.auth = auth;
        window.getFirestore = getFirestore;
        window.collection = collection;
        window.addDoc = addDoc;
        window.onSnapshot = onSnapshot;
        window.query = query;
        window.orderBy = orderBy;
        window.where = where;
        window.deleteDoc = deleteDoc;
        window.doc = doc;
        window.updateDoc = updateDoc;
        window.getDocs = getDocs;
        window.getDoc = getDoc;
        window.increment = increment;
        window.serverTimestamp = serverTimestamp;
        window.setDoc = setDoc;

        // Initialize after Firebase is ready
        setTimeout(() => {
            // Load Firebase CV config
            const script = document.createElement('script');
            script.src = 'firebase-cv-config.js';
            document.body.appendChild(script);
        }, 500);
    </script>
    
    <script src="script.js"></script>
</body>
</html>
